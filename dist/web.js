!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t,i){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const s=n(i(2)),r=n(i(3)),a=r.createConnection({host:s.HOST,port:s.PORT,user:s.USER,password:s.PASS,database:s.DB});class o{constructor(e){this.table=e}static parseExpression(e){const t=[];return e.forEach(e=>{const i=e=>t.push(`${n}=${e}`),n=Object.keys(e)[0],s=e[n];switch(typeof s){case"string":i(`"${s}"`);break;case"number":i(s);break;case"object":i(r.escape(JSON.stringify(s)))}}),t}find(...e){return new Promise((t,i)=>{const n=o.parseExpression(e);a.query(`SELECT * FROM ${this.table} WHERE ${n.join(" , ")}`,(e,n)=>{e?i(e):t(n)})})}findOne(...e){return new Promise((t,i)=>{const n=o.parseExpression(e);a.query(`SELECT * FROM ${this.table} WHERE ${n.join(" , ")}`,(e,n)=>{e?i(e):t(n[0])})})}add(...e){return new Promise((t,i)=>{const n=e.map(e=>"object"==typeof e?`'${JSON.stringify(e)}'`:`"${e}"`);a.query(`INSERT INTO ${this.table} VALUES (${n.join(" , ")})`,e=>{e?i(e):t()})})}update(e,t){return new Promise((i,n)=>{const s=o.parseExpression(e),r=o.parseExpression(t);a.query(`UPDATE ${this.table} SET ${r.join(" , ")} WHERE ${s.join(" ")}`,e=>{e?n(e):i()})})}delete(e){return new Promise((t,i)=>{const n=o.parseExpression(e);a.query(`DELETE FROM ${this.table} WHERE ${n.join(" ")}`,e=>{e?i(e):t()})})}}t.default={TABLE:{users:new o("users"),item:new o("item"),session:new o("session"),mobs:new o("mobs")}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static time(){const e=new Date;return[e.getFullYear(),"-",e.getMonth()+1,"-",e.getDate()," ",e.getHours(),":",e.getMinutes(),":",e.getSeconds(),":",e.getMilliseconds()].join("")}static random(e,t){return Math.floor(Math.random()*(t-e+1)+e)}}},function(e){e.exports=JSON.parse('{"PORT":3306,"HOST":"localhost","USER":"root","PASS":"ckfejrvkdl4!","DB":"step-by-step"}')},function(e,t){e.exports=require("mysql")},function(e){e.exports=JSON.parse('{"clientID":"85980254947-tbpk5bogtbg9egmsievv1gbmrtmsibel.apps.googleusercontent.com","clientSecret":"vepcxiwShQNOQMLllW8t_VOZ","callbackURL":"http://lotix.kro.kr/auth/google/callback","SESSION_SECRET":"TEST1234"}')},function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(i(1));t.default=class{constructor(e,t="green"){this.label=e,this.color=t}trace(e){console.log(`${this.label} | ${s.default.time()} | ${e}`)}}},function(e){e.exports=JSON.parse('{"INTERNAL_WS_URL":"127.0.0.2","WS_PORT":7010}')},function(e,t){e.exports=require("express")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function a(e){try{u(n.next(e))}catch(e){r(e)}}function o(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=s(i(0)),o=s(i(12)),u=r(i(4)),c=i(13),l=i(14);t.init=function(e,t){e.use(new c.Strategy({clientID:u.clientID,clientSecret:u.clientSecret,callbackURL:u.callbackURL,passReqToCallback:!0},(e,t,i,s,r)=>{process.nextTick(()=>n(this,void 0,void 0,(function*(){return(yield a.default.TABLE.users.findOne({id:s.id}))||(yield a.default.TABLE.users.add(s.id,"{}",1,0,"earth",l.baseStat,"{}")),e.session.profile={id:s.id},yield a.default.TABLE.session.add(e.session.id,e.session.profile,Date.now()),r(void 0,s)})))})),t.use(o.default({secret:u.SESSION_SECRET,resave:!0,saveUninitialized:!1})),t.use(e.initialize()),t.use(e.session()),e.serializeUser((e,t)=>{t(null,e)}),e.deserializeUser((e,t)=>{t(null,e)}),t.get("/auth/google",e.authenticate("google",{scope:["profile"]})),t.get("/auth/google/callback",e.authenticate("google",{failureRedirect:"/",successRedirect:"/game"}))},t.isAuthenticated=function(e,t,i){if(e.isAuthenticated())return i();t.redirect("/")}},function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=n(i(7)),a=n(i(10)),o=n(i(11)),u=n(i(0)),c=s(i(8)),l=n(i(17)),d=n(i(5)),f=s(i(6)),p=n(i(18)),_=s(i(19)),h=r.default(),y=(l.default(`ws://${f.INTERNAL_WS_URL}:${f.WS_PORT}`),new d.default("WEB","red"));c.init(p.default,h),h.use(r.default.static(a.default.resolve(__dirname,"assets"))),h.use(_.urlencoded()),h.set("views",a.default.resolve(__dirname,"views")),h.set("view engine","pug"),h.use("/",o.default()),h.listen(80,()=>{y.trace("Web Server opened.")});const b={wooden_sword:{price:100,name:"나무 검",rare:"normal",reqLV:0,level:{value:1,star:1},stat:{atk:3},description:"초보자용 나무 검이다.",atk_type:"attack",type:"sword"},lava_pendant:{price:100,name:"라바 펜던트",rare:"legendary",reqLV:250,level:{value:167,star:6},stat:{atk:455,def:20,atk_speed:10,ignore_protection:45,critical_chance:70,critical_damage:4.5},description:"전설적인 불의 새의 심장에 있는 보석이 박힌 펜던트이다.",atk_type:"buff",type:"pendant"},trace_of_the_void:{price:100,name:"공허의 흔적",rare:"mythic",reqLV:900,level:{value:520,star:7},stat:{atk:1765e3},description:"알 수 없는 공간에서 한 연구원이 떼어 온 공허(보이드) 의 흔적이다.\n주변 공간을 일그러뜨리고 있다.",atk_type:"buff",type:"pendant"},burning_heart:{price:100,name:"버닝 하트",rare:"epic",reqLV:85,level:{value:47,star:5},stat:{atk:10,health:100,critical_chance:0,critical_damage:1.5,atk_speed:1,def:0,accuracy:0,luck:0,ignore_protection:0,multishot:0},description:"전설 속 정의 영혼이 가졌던 불타는 심장이다. 죽지 않고 살아있다.",atk_type:"buff",type:"pendant"},echani:{price:100,name:"에찬이",rare:"mythic",reqLV:999,level:{value:750,star:7},stat:{atk:55400,ignore_protection:95,critical_chance:100,critical_damage:12,atk_speed:10,health:500},description:"에찬이다.",atk_type:"buff",type:"pendant"}};u.default.TABLE.users.update([{id:"114771621283891074143"}],[{inventory:b}])},function(e,t){e.exports=require("path")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function a(e){try{u(n.next(e))}catch(e){r(e)}}function o(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=s(i(7)),o=r(i(8)),u=s(i(0)),c=r(i(15)),l=s(i(16));t.default=function(){const e=a.default.Router();return e.get("/game",o.isAuthenticated,(e,t)=>{t.render("game")}),e.get("/",(e,t)=>n(this,void 0,void 0,(function*(){if(e.session){const t=yield u.default.TABLE.session.findOne([{id:e.session.id}]);new Date-t.createdAt>3e6&&(yield u.default.TABLE.session.delete([{id:e.session.id}]),e.session.destroy(()=>{}))}t.render("index")}))),e.get("/setupLangTable",(e,t)=>{t.send(`window.LANGUAGE_TABLE = ${JSON.stringify(c)};`)}),l.default(e),e}},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("passport-google-oauth20")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseStat={atk:10,health:100,critical_chance:0,critical_damage:1.5,atk_speed:1,def:0,accuracy:0,luck:0,ignore_protection:0,multishot:0}},function(e){e.exports=JSON.parse('{"boss":{"Alycia":"아리시아","Adelheid":"아델하이트","Charlotte":"샤를로테"},"playerstat_atk":"공격력","playerstat_health":"체력","playerstat_critical_chance":"치명타 확률","playerstat_critical_damage":"치명타 피해 배율","playerstat_atk_speed":"공격 속도","playerstat_def":"방어력","playerstat_accuracy":"정확도","playerstat_luck":"운","playerstat_ignore_protection":"방어력 무시","playerstat_multishot":"발사체 개수","statinfo_atk":"실질적으로 입히는 피해에 가장 크게 관여하는 최종 수치","statinfo_health":"플레이어의 체력","statinfo_critical_chance":"기본 공격 시 치명타로 더 강력한 피해를 입힐 확률","statinfo_critical_damage":"치명타 공격 시 공격력에 적용될 배율","statinfo_atk_speed":"기본 공격의 투사체 발사 속도","statinfo_def":"적으로부터 받는 피해를 무시하는 정도 (%)","statinfo_accuracy":"적이 공격을 회피하지 못하도록 하는 정도","statinfo_luck":"아이템, 골드 발견 등의 확률과 품질을 높여주는 정도","statinfo_ignore_protection":"적의 방어력을 무시하는 정도 (%)","statinfo_multishot":"기본 공격 시 생성하는 투사체의 개수"}')},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function a(e){try{u(n.next(e))}catch(e){r(e)}}function o(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(i(0)),a={earth:0,immune:30,eternal_prison:55,harbinger_of_end:80,arkcube_piece:100,loard_down_benzene:200};t.default=function(e){e.post("/changeStage",(e,t)=>n(this,void 0,void 0,(function*(){(yield r.default.TABLE.users.findOne({id:e.session.profile.id})).level>=a[e.body.stage]?(yield r.default.TABLE.users.update([{id:e.session.profile.id}],[{stage:e.body.stage}]),t.send({success:!0})):t.send({success:!1})}))),e.post("/equipItem",(e,t)=>n(this,void 0,void 0,(function*(){const i=yield r.default.TABLE.users.findOne({id:e.session.profile.id}),n=JSON.parse(i.equip);n[e.body.item]=JSON.parse(i.inventory)[e.body.item];const s=JSON.parse(i.stat);for(const t in e.body.stat)s[t]+=parseInt(e.body.stat[t]);yield r.default.TABLE.users.update([{id:e.session.profile.id}],[{equip:n}]),yield r.default.TABLE.users.update([{id:e.session.profile.id}],[{stat:s}]),t.send({success:!0,stat:s})}))),e.post("/equipOffItem",(e,t)=>n(this,void 0,void 0,(function*(){const i=yield r.default.TABLE.users.findOne({id:e.session.profile.id}),n=JSON.parse(i.equip);delete n[e.body.item];const s=JSON.parse(i.stat);for(const t in e.body.stat)s[t]-=parseInt(e.body.stat[t]);yield r.default.TABLE.users.update([{id:e.session.profile.id}],[{equip:n}]),yield r.default.TABLE.users.update([{id:e.session.profile.id}],[{stat:s}]),t.send({success:!0,stat:s})})))}},function(e,t){e.exports=require("socket.io-client")},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("body-parser")}]);